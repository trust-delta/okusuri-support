---
name: production-readiness
description: 本番環境への準備状況を包括的にチェックする。初回リリース前、大規模機能追加後、定期的な健全性チェックに使用する。
---

# Production Readiness

本番環境へのデプロイ準備状況を包括的にチェックするスキル。

## 利用シーン

- 初回リリース前の最終確認
- 大規模な機能追加後のリリース前確認
- 定期的な本番環境の健全性チェック

## 使用例

- 「本番準備できてる？」
- 「プロダクションレディネスチェック」
- 「リリース前の最終確認」
- 「本番環境の準備状況を確認」

---

## チェックカテゴリ

### 1. セキュリティ
認証・認可・保護の設定状況

### 2. 監視・ロギング
エラー監視、ログ収集の設定状況

### 3. パフォーマンス
応答速度、最適化の状況

### 4. 品質
テスト、型チェック、Lint の状況

### 5. 運用
環境変数、ドキュメント、CI/CD の状況

---

## 実行フロー

### 1. 情報収集
```bash
# 設定ファイルの確認
Read: next.config.ts
Read: middleware.ts
Read: sentry.*.config.ts

# 環境変数の確認
Read: .env.example

# テスト・品質チェック
npm run type-check
npm run lint
pnpm audit
```

### 2. チェック実行
各カテゴリのチェック項目を評価

### 3. レポート生成
準備状況をスコア化してレポート

---

## チェックリスト

### セキュリティ (必須)
- [ ] 認証ミドルウェアで全ての保護対象ルートがカバーされている
- [ ] セキュリティヘッダーが設定されている
- [ ] 機密情報がコードにハードコードされていない
- [ ] CORS 設定が適切
- [ ] HTTPS が強制されている (HSTS)

### 監視・ロギング (必須)
- [ ] エラー監視サービス（Sentry等）が設定されている
- [ ] クライアント・サーバー両方でエラーがキャプチャされる
- [ ] 適切なサンプリングレートが設定されている
- [ ] PII（個人識別情報）が送信されない設定になっている

### パフォーマンス (推奨)
- [ ] 画像が最適化されている (next/image)
- [ ] 適切なキャッシュ設定がある
- [ ] Core Web Vitals が基準を満たしている
- [ ] 不要なバンドルサイズが削減されている

### 品質 (必須)
- [ ] 型チェックがパスする
- [ ] Lint エラーがない
- [ ] テストがパスする
- [ ] npm audit で high/critical の脆弱性がない

### 運用 (推奨)
- [ ] .env.example が最新で、必要な環境変数が全て記載されている
- [ ] README が最新
- [ ] デプロイ手順が文書化されている
- [ ] ロールバック手順がある

---

## 出力フォーマット

```markdown
## 本番準備状況レポート

### 総合評価: ✅ 準備完了 / ⚠️ 一部要対応 / ❌ 未準備

### スコア: 85/100

---

### セキュリティ (25/25) ✅
- [x] 認証ミドルウェア: 8ルートを保護
- [x] セキュリティヘッダー: 6種類設定済み
- [x] ハードコード検出: なし
- [x] HTTPS強制: HSTS設定済み

### 監視・ロギング (20/25) ⚠️
- [x] Sentry: 設定済み
- [x] クライアント: 設定済み
- [x] サーバー: 設定済み
- [ ] サンプリングレート: 10%（低すぎる可能性）

### パフォーマンス (15/20) ⚠️
- [x] next/image: 使用中
- [x] キャッシュ: 設定済み
- [ ] バンドルサイズ: 最適化の余地あり

### 品質 (25/25) ✅
- [x] 型チェック: パス
- [x] Lint: エラーなし
- [x] テスト: 12/12 パス
- [x] npm audit: 脆弱性なし

### 運用 (0/5) ❌
- [ ] README: 更新が必要
- [ ] デプロイ手順: 未文書化

---

### 推奨アクション

#### 優先度: 高
1. README を更新してセットアップ手順を追記

#### 優先度: 中
1. Sentry サンプリングレートを本番負荷に応じて調整
2. バンドル分析を実行して最適化検討

#### 優先度: 低
1. デプロイ・ロールバック手順を文書化
```

---

## 関連スキル

- **review-assistant**: PR前のコードレビュー
- **security-audit**: セキュリティ特化の詳細監査
- **dependency-checker**: 依存関係の脆弱性チェック

---

## 注意事項

1. **チェックは目安**: 全ての項目をパスしても、ビジネス要件に応じた追加確認が必要な場合がある
2. **段階的改善**: 全てを一度に対応する必要はない。優先度に応じて段階的に改善
3. **自動化との併用**: CI/CD パイプラインでの自動チェックと併用することを推奨

---

**最終更新**: 2025年11月30日
