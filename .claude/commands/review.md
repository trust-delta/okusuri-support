---
description: Design Doc準拠検証と必要に応じた自動修正
---

**コマンドコンテキスト**: 実装完了後の品質保証専用コマンド

Design Doc（省略時は直近のもの）: $ARGUMENTS

**Think deeply** 準拠検証の本質を理解し、以下のステップで実行：

## 実行フロー

### 1. 前提確認
```bash
# Design Docの特定
ls docs/design/*.md | grep -v template | tail -1

# 実装ファイル確認
git diff --name-only main...HEAD
```

### 2. code-reviewer実行
Design Doc準拠率を検証：
- 受入条件の充足確認
- コード品質チェック
- 実装完全性の評価

### 3. 判定と対応

**判定基準（プロジェクト段階を考慮）**:
- プロトタイプ: 70%以上で合格
- 本番実装: 90%以上推奨
- 重要項目（セキュリティ等）: 準拠率に関わらず必須

**準拠率に基づく対応**:

準拠率が低い場合（本番で90%未満）:
```
検証結果: 準拠率 [X]%
未充足項目:
- [項目リスト]

修正を実行しますか？ (y/n): 
```

ユーザーが `y` を選択した場合:

## 🧠 修正実行前のメタ認知
**必須**: `rule-advisor → TodoWrite → task-executor → quality-fixer`

1. **rule-advisor実行**: 修正の本質を理解（表面的な対症療法 vs 根本解決）
2. **TodoWrite更新**: 修正タスクを構造化 → `docs/plans/tasks/review-fixes-YYYYMMDD.md`
3. **task-executor実行**: 自動修正を段階的実行（5ファイル超過で停止）
4. **quality-fixer実行**: 品質ゲート通過を確認
5. **再検証**: code-reviewerで改善度を測定

### 4. 最終レポート
```
初回準拠率: [X]%
最終準拠率: [Y]%（修正実行時）
改善度: [Y-X]%

残存課題:
- [手動対応が必要な項目]
```

## 自動修正可能な項目
- 単純な未実装の受入条件
- エラーハンドリング追加
- 型定義の修正
- 関数分割（長さ・複雑度の改善）

## 自動修正不可能な項目
- ビジネスロジックの根本的変更
- アーキテクチャレベルの修正
- Design Doc自体の不備

**スコープ**: Design Doc準拠検証と自動修正まで。