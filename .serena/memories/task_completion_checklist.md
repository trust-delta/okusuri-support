# タスク完了時のチェックリスト

## 必須実行プロセス（CLAUDE.mdルール準拠）

### 1. 実装前チェック
- [ ] **TodoWriteでタスク分解済み**: なければ実装ステップに進めない
- [ ] **rule-advisor実行済み**: タスクの本質理解と適切なルール選択
- [ ] **ユーザー承認取得済み**: Edit/Write/MultiEdit使用前の明示的承認

### 2. 実装中チェック
- [ ] **any型使用回避**: unknown型+型ガードを使用
- [ ] **型安全性確保**: TypeScriptの厳格設定に準拠
- [ ] **コーディング規約準拠**: Biome設定に基づくフォーマット・Lintルール

### 3. 品質チェック（段階的実行）

#### Phase 1: コードフォーマット・Lint
```bash
npm run check:fix      # 自動修正実行
npm run lint           # Lintチェック
```
- [ ] **Biome check通過**: フォーマット・Lintエラー0件
- [ ] **any型警告解消**: suspicious.noExplicitAny警告0件

#### Phase 2: TypeScript型チェック
```bash
npx tsc --noEmit       # 型チェックのみ実行
```
- [ ] **型エラー0件**: 全ての型エラーを解消
- [ ] **厳格型チェック通過**: tsconfig.jsonの厳格設定準拠

#### Phase 3: 未使用コード・循環依存チェック
```bash
npm run check:unused   # 未使用エクスポート検出
npm run check:deps     # 循環依存チェック
```
- [ ] **未使用エクスポート0件**: 不要なエクスポートを削除
- [ ] **循環依存0件**: アーキテクチャ設計の確認・修正

#### Phase 4: テスト実行
```bash
npm run test:coverage:fresh  # キャッシュクリア後テスト実行
```
- [ ] **全テスト通過**: 既存テストの破綻なし
- [ ] **新規テスト作成**: 新機能・修正に対する適切なテスト
- [ ] **カバレッジ維持**: 最低70%のテストカバレッジ

#### Phase 5: ビルドチェック
```bash
npm run build          # プロダクションビルド
```
- [ ] **ビルド成功**: エラー・警告0件でビルド完了
- [ ] **Next.js最適化**: 静的分析・バンドル最適化の確認

#### Phase 6: E2Eテスト（必要に応じて）
```bash
npm run test:e2e       # Playwright E2Eテスト
```
- [ ] **E2Eテスト通過**: 主要ユーザーフローの動作確認
- [ ] **UI/UX検証**: 視覚的・操作的な品質確認

### 4. 最終確認

#### 包括的品質チェック
```bash
npm run check:all      # 全品質チェック一括実行
```
- [ ] **全チェック通過**: check:all実行でエラー0件

#### ドキュメント・コミット準備
- [ ] **コードコメント**: 複雑な処理に適切なコメント
- [ ] **型定義エクスポート**: 必要な型定義の適切なエクスポート
- [ ] **リファクタリング検討**: 重複コード・設計改善の検討

### 5. 自動停止トリガー回避チェック

- [ ] **5ファイル以上変更**: 大規模変更時は影響範囲をユーザーに報告
- [ ] **同じエラー3回**: 根本原因分析を実施済み
- [ ] **unknown型多用**: 型ガード設計を適切に実施
- [ ] **3ファイル編集完了**: TodoWriteの更新を実施

### 6. エスカレーション事項確認

以下に該当する場合はユーザー確認必須：
- [ ] **アーキテクチャ変更**: 新レイヤー追加・責務変更
- [ ] **外部依存追加**: npmパッケージ・外部API追加
- [ ] **破壊的変更**: 既存APIの変更・データ構造の変更
- [ ] **実装方法選択**: 複数の選択肢で優劣判断困難

## 完了条件

**全てのチェック項目が完了し、エラー0件の状態でのみタスク完了とする**

品質エラーが残存している状態での完了宣言は、CLAUDE.mdルール違反として禁止されています。